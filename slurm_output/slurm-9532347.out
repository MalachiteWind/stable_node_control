Now you should run one of the following depending on your shell
source /share/apps/python/miniconda24.4.0/etc/profile.d/conda.sh
source /share/apps/python/miniconda24.4.0/etc/profile.d/conda.csh
  0%|                                                                                                                                                                                                                                                                                             | 0/250 [00:00<?, ?it/s] 39%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                        | 97/250 [00:00<00:00, 963.07it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                    | 217/250 [00:00<00:00, 1092.92it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [00:00<00:00, 955.60it/s]
  0%|                                                                                                                                                                                                                                                                                             | 0/250 [00:00<?, ?it/s] 24%|██████████████████████████████████████████████████████████████████                                                                                                                                                                                                                 | 60/250 [00:00<00:00, 594.52it/s] 51%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                      | 127/250 [00:00<00:00, 638.35it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                 | 220/250 [00:00<00:00, 768.58it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [00:00<00:00, 746.11it/s]
/qfs/projects/atscale/atscale_dyn/Code/Ike/stable_node_control/stabnode/node.py:259: UserWarning: rk4 failure. Using fallback method 'dopri5'. Error: NaN in ODE Solution.
  warnings.warn(f"{solve_method} failure. Using fallback method 'dopri5'. Error: {e}")
Traceback (most recent call last):
  File "/qfs/projects/atscale/atscale_dyn/Code/Ike/stable_node_control/stabnode/node.py", line 255, in model_trainer
    raise ValueError("NaN in ODE Solution.")
ValueError: NaN in ODE Solution.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/qfs/projects/atscale/atscale_dyn/Code/Ike/stable_node_control/train_budworm.py", line 140, in <module>
    main(
  File "/qfs/projects/atscale/atscale_dyn/Code/Ike/stable_node_control/train_budworm.py", line 111, in main
    stab_node, log_history = model_trainer(
                             ^^^^^^^^^^^^^^
  File "/qfs/projects/atscale/atscale_dyn/Code/Ike/stable_node_control/stabnode/node.py", line 260, in model_trainer
    X_pred = odeint(lambda t, x: model(t,x,control), x0, tau_span, method='dopri5')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/people/gris332/.conda/envs/atscale/lib/python3.11/site-packages/torchdiffeq/_impl/odeint.py", line 80, in odeint
    solution = solver.integrate(t)
               ^^^^^^^^^^^^^^^^^^^
  File "/people/gris332/.conda/envs/atscale/lib/python3.11/site-packages/torchdiffeq/_impl/solvers.py", line 32, in integrate
    self._before_integrate(t)
  File "/people/gris332/.conda/envs/atscale/lib/python3.11/site-packages/torchdiffeq/_impl/rk_common.py", line 215, in _before_integrate
    first_step = _select_initial_step(self.func, t[0], self.y0, self.order - 1, self.rtol, self.atol,
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/people/gris332/.conda/envs/atscale/lib/python3.11/site-packages/torchdiffeq/_impl/misc.py", line 67, in _select_initial_step
    f1 = func(t0 + h0, y1)
         ^^^^^^^^^^^^^^^^^
  File "/people/gris332/.conda/envs/atscale/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/people/gris332/.conda/envs/atscale/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/people/gris332/.conda/envs/atscale/lib/python3.11/site-packages/torchdiffeq/_impl/misc.py", line 197, in forward
    return self.base_func(t, y)
           ^^^^^^^^^^^^^^^^^^^^
  File "/qfs/projects/atscale/atscale_dyn/Code/Ike/stable_node_control/stabnode/node.py", line 260, in <lambda>
    X_pred = odeint(lambda t, x: model(t,x,control), x0, tau_span, method='dopri5')
                                 ^^^^^^^^^^^^^^^^^^
  File "/people/gris332/.conda/envs/atscale/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/people/gris332/.conda/envs/atscale/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/qfs/projects/atscale/atscale_dyn/Code/Ike/stable_node_control/stabnode/node.py", line 109, in forward
    u = u_func(t).unsqueeze(0).unsqueeze(1)
        ^^^^^^^^^
  File "/qfs/projects/atscale/atscale_dyn/Code/Ike/stable_node_control/train_budworm.py", line 91, in K_func
    idx = int(tau) % len(K)
          ^^^^^^^^
ValueError: cannot convert float NaN to integer
  0%|                                                                                                                                                                                                                                                                                             | 0/250 [00:00<?, ?it/s] 38%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                                          | 95/250 [00:00<00:00, 945.05it/s] 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                       | 214/250 [00:00<00:00, 1088.05it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [00:00<00:00, 933.96it/s]
  0%|                                                                                                                                                                                                                                                                                             | 0/250 [00:00<?, ?it/s] 24%|██████████████████████████████████████████████████████████████████                                                                                                                                                                                                                 | 60/250 [00:00<00:00, 593.35it/s] 50%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                        | 126/250 [00:00<00:00, 629.81it/s] 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                   | 218/250 [00:00<00:00, 758.20it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [00:00<00:00, 737.15it/s]
  0%|                                                                                                                                                                                                                                                                                             | 0/250 [00:00<?, ?it/s] 39%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                        | 97/250 [00:00<00:00, 963.13it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                    | 217/250 [00:00<00:00, 1092.00it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [00:00<00:00, 951.87it/s]
  0%|                                                                                                                                                                                                                                                                                             | 0/250 [00:00<?, ?it/s] 24%|███████████████████████████████████████████████████████████████████                                                                                                                                                                                                                | 61/250 [00:00<00:00, 604.45it/s] 52%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                    | 129/250 [00:00<00:00, 645.57it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                              | 222/250 [00:00<00:00, 773.48it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [00:00<00:00, 749.92it/s]
